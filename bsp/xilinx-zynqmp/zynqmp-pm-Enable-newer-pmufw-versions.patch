From ff42814fdd3b0fee98b72ecc8bfe3b025f7270d1 Mon Sep 17 00:00:00 2001
From: Rajan Vaja <rajan.vaja@xilinx.com>
Date: Wed, 14 Feb 2018 03:48:43 -0800
Subject: [PATCH 2/2] zynqmp: pm: Enable newer pmufw versions

As of now newer pmufw is keeping old interfaces. That's why
permit Linux to run on newer version. Recommended version will be
setup later.

And also show actual fw version not minimal one.

Signed-off-by: Rajan Vaja <rajanv@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Liu Haitao <haitao.liu@windriver.com>
Signed-off-by: Zhixiong Chi <zhixiong.chi@windriver.com>
---
 drivers/soc/xilinx/zynqmp/pm.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/soc/xilinx/zynqmp/pm.c b/drivers/soc/xilinx/zynqmp/pm.c
index 0519fa3742f7..ff8bc85bdf18 100644
--- a/drivers/soc/xilinx/zynqmp/pm.c
+++ b/drivers/soc/xilinx/zynqmp/pm.c
@@ -1145,7 +1145,7 @@ static int zynqmp_pm_probe(struct platform_device *pdev)
 	zynqmp_pm_get_api_version(&pm_api_version);
 
 	/* Check PM API version number */
-	if (pm_api_version != ZYNQMP_PM_VERSION)
+	if (pm_api_version < ZYNQMP_PM_VERSION)
 		return -ENODEV;
 
 	irq = platform_get_irq(pdev, 0);
@@ -1177,7 +1177,7 @@ static int zynqmp_pm_probe(struct platform_device *pdev)
 	}
 
 	dev_info(&pdev->dev, "Power management API v%d.%d\n",
-		ZYNQMP_PM_VERSION_MAJOR, ZYNQMP_PM_VERSION_MINOR);
+		pm_api_version >> 16, pm_api_version & 0xFFFF);
 
 	zynqmp_pm_api_debugfs_init(&pdev->dev);
 
-- 
2.17.1

